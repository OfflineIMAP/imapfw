
language: python
python:
  - "3.4"
  - "3.5"
  - "3.6" # currently points to 3.6-dev
  - "3.6-dev" # 3.6 development branch
  # - "nightly" # disabled because testing against unstable yields to many false positives
  #- "pypy3"  # won't work since it implements Python 3.2.5.

branches:
  only:
    - master
    - next
    - support_python_3.6

before_install:
  - pip install --upgrade pip
  - pip install pipenv
  - pipenv run python --version

# command to install dependencies
install: pipenv install --dev

#before_script:
  #- cp -a ./tests "$TRAVIS_BUILD_DIR"

notifications:
  webhooks:
    urls:
      - https://webhooks.gitter.im/e/0d4fe7da7dd072da59ea
    on_success: always  # options: [always|never|change] default: always
    on_failure: always  # options: [always|never|change] default: always
    on_start: never

# command to run tests
script:
  - pipenv run coverage run --source=imapfw,imapfw.py -p -m imapfw.edmp
  - pipenv run coverage run --source=imapfw,imapfw.py -p -m imapfw.mmp.manager
  - pipenv run coverage run --source=imapfw,imapfw.py -p ./imapfw.py -h
  - pipenv run coverage run --source=imapfw,imapfw.py -p ./imapfw.py noop
  - pipenv run coverage run --source=imapfw,imapfw.py -p ./imapfw.py -c multiprocessing unitTests
  - pipenv run coverage run --source=imapfw,imapfw.py -p ./imapfw.py -c threading unitTests
  - pipenv run coverage run --source=imapfw,imapfw.py -p ./imapfw.py -r ./tests/syncaccounts.1.rascal -d all noop
  - pipenv run coverage run --source=imapfw,imapfw.py -p ./imapfw.py -r ./tests/syncaccounts.1.rascal -d all testRascal
  - pipenv run coverage run --source=imapfw,imapfw.py -p ./imapfw.py -r ./tests/syncaccounts.1.rascal -d all examine
  - pipenv run coverage run --source=imapfw,imapfw.py -p ./imapfw.py -r ./tests/syncaccounts.1.rascal -d all -c multiprocessing syncAccounts -a AccountA
  - pipenv run coverage run --source=imapfw,imapfw.py -p ./imapfw.py -r ./tests/syncaccounts.1.rascal -d all -c threading syncAccounts -a AccountA
  - pipenv run coverage run --source=imapfw,imapfw.py -p ./imapfw.py -r ./tests/syncaccounts.1.rascal -d all -c threading syncAccounts -a AccountA -a AccountA -a AccountA
  - pipenv run coverage combine .coverage*

after_success:
  - pipenv run coveralls
  - pipenv run codecov
# vim: expandtab ts=2 :
